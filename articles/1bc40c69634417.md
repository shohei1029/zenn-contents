---
title: "Pandas AIã‚’Azure OpenAI Serviceã§å‹•ã‹ã™"
emoji: "ğŸ¼"
type: "tech"
topics:
  - "azure"
  - "pandas"
  - "openai"
  - "chatgpt"
published: true
published_at: "2023-05-29 14:39"
publication_name: "microsoft"
---

# ã¯ã˜ã‚ã«
[Pandas AI](https://github.com/gventuri/pandas-ai)ã¯Pandasã«AIæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚Pandas AIã‚’ä½¿ã†ã¨ã€è‡ªç„¶è¨€èªã«ã‚ˆã£ã¦pandas dataframeã‹ã‚‰ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ãŸã‚Šã€dataframeã‹ã‚‰ã‚°ãƒ©ãƒ•ã‚’æç”»ã—ãŸã‚Šã¨ã€pandasã®æ“ä½œãŒåœ§å€’çš„ã«æ¥½ã«ãªã‚Šã¾ã™ã€‚

å…¬å¼ãƒªãƒã®ã‚µãƒ³ãƒ—ãƒ«ãŒOpenAIç¤¾APIã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã€Azure OpenAI Serviceã®å ´åˆã¯ã©ã†ã‚„ã£ã¦æ¥ç¶šã™ã‚‹ã‹ç°¡å˜ã«æ¤œè¨¼ã—ã¦ã¾ã¨ã‚ã¾ã—ãŸã€‚

# ä½¿ã„æ–¹
## æº–å‚™
```zsh
$ pip install pandasai
```

## å®Ÿè¡Œ
ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã«ãªã‚Šã¾ã™ã€‚å…¬å¼ãƒªãƒã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ã€‚
å›½åˆ¥ã®GDPã¨å¹¸ç¦åº¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚Šã€ãã“ã‹ã‚‰ChatGPT (`gpt-35-turbo`)ã«æœ€ã‚‚å¹¸ç¦ãªå›½ã‚’5ã¤æŠ½å‡ºã•ã›ã¦ã„ã¾ã™ã€‚

```python
import os
import pandas as pd
from pandasai import PandasAI
from pandasai.llm.azure_openai import AzureOpenAI

api_base = "<AZURE_OPENAI_API_BASE>"
api_key = "<AZURE_OPENAI_API_KEY>"

# Sample DataFrame
df = pd.DataFrame({
    "country": ["United States", "United Kingdom", "France", "Germany", "Italy", "Spain", "Canada", "Australia", "Japan", "China"],
    "gdp": [19294482071552, 2891615567872, 2411255037952, 3435817336832, 1745433788416, 1181205135360, 1607402389504, 1490967855104, 4380756541440, 14631844184064],
    "happiness_index": [6.94, 7.16, 6.66, 7.07, 6.38, 6.4, 7.23, 7.22, 5.87, 5.12]
})

# Instantiate a LLM
llm = AzureOpenAI(api_base = api_base,
                  api_version = "2023-03-15-preview",
                  api_token = api_key,
                  deployment_name = "gpt-35-turbo")

pandas_ai = PandasAI(llm, conversational=False)
print(pandas_ai(df, prompt='Which are the 5 happiest countries?'))
```

ã“ã®ã‚ˆã†ã«çµæœãŒè¿”ã£ã¦ãã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/48aaddb70919-20230529.png)

`api_base`ã¨`api_key`ã«çš†ã•ã‚“ã®Azure OpenAIãƒªã‚½ãƒ¼ã‚¹ã®URLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨APIã‚­ãƒ¼ãŒä»£å…¥ã•ã‚Œã‚‹å½¢ã«ã—ã¾ã™ã€‚
ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã‚’è¦‹ã‚‹ã¨ã€æŒ‡å®šãªã—ã ã¨ãã‚Œãã‚Œç’°å¢ƒå¤‰æ•°ã®`AZURE_OPENAI_ENDPOINT`ã¨`AZURE_OPENAI_KEY`ã‚’èª­ã¿è¾¼ã‚€å½¢ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

è¨ˆç®—ã•ã›ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/c2399fa4d3a6-20230529.png)

ã‚°ãƒ©ãƒ•ã‚’æç”»ã•ã›ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/375f5f6950f8-20230529.png)

# å‚è€ƒ
[gventuri/pandas-ai: Pandas AI is a Python library that integrates generative artificial intelligence capabilities into Pandas, making dataframes conversational](https://github.com/gventuri/pandas-ai)
[pandas-ai/azure_openai.py at main Â· gventuri/pandas-ai Â· GitHub](https://github.com/gventuri/pandas-ai/blob/main/pandasai/llm/azure_openai.py)

